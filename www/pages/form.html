<template>
<div class="page" data-name="item_form">
  <div class="navbar">
    <div class="navbar-inner sliding">
      <div class="left">
        <a href="#" class="back link">
          <i class="icon icon-back"></i>
          <span class="ios-only">Back</span>
        </a>
      </div>
      <div class="title">Edit</div>
      <div class="right">
        <a href="#" class="link icon-only">
          <i class="icon f7-icons ios-only">menu</i>
          <i class="icon material-icons md-only">notifications</i>
        </a>
      </div>
    </div>
  </div>
  <div class="page-content">
    <!-- <div class="block-title">EDIT</div> -->
    <!-- <form id="setting-form" action="send-here.html" method="POST" class="form-ajax-submit" enctype="multipart/form-data"> -->
    <form id="item-form">
    <div class="list no-hairlines-md">
      <ul>
        <input type="hidden" name="uid" placeholder="Your name" value="{{item.iid}}"/>
        <li>
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Nama Item</div>
              <div class="item-input-wrap">
                <input type="text" name="fname" placeholder="Your name" value="{{item.iname}}" />
              </div>
            </div>
          </div>
        </li>
        <li>
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Kode Barang</div>
              <div class="item-input-wrap">
                <input type="text" name="icode" placeholder="Your name" value="{{item.icode}}" />
              </div>
            </div>
          </div>
        </li>
        <li>
          <!-- bprice: 150000
          catid: 1
          created: "2018-10-28 05:26:17"
          icode: "S_H_SACK"
          iid: 3000001
          iname: "SEMEN HOLCIM SACK 50 KG"
          modified: "2018-10-28 06:24:50"
          note: ""
          status: 1
          unitid: 1
          xsprice: 0
          ysprice: 0
          zsprice: 0 -->
          <a class="item-link smart-select category">
            <select name="catid">
              
              <!-- <option value="1" selected>SEMEN</option>
              <option value="2">PASIR</option>
              <option value="3">MUR</option>
              <option value="4">BAUT</option>
              <option value="5">GRAM</option> -->
              {{#categories}}

              <option value="{{id}}" {{#js_if '../item.catid.id == this.id'}}selected{{else}}{{/js_if}} >{{name}}</option>
              
              {{/categories}}
              

            </select>
            <div class="item-content">
              <div class="item-inner">
                <div class="item-title">Kategori</div>
              </div>
            </div>
          </a>
        </li>
        <li>
          <a class="item-link smart-select unit">
            <select name="unitid">
              {{#units}}

              <option value="{{id}}" {{#js_if '../item.unitid.id == this.id'}}selected{{else}}{{/js_if}} >{{name}}</option>
              
              {{/units}}
            </select>
            <div class="item-content">
              <div class="item-inner">
                <div class="item-title">Unit</div>
              </div>
            </div>
          </a>
        </li>

        <li>
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Harga Beli</div>
              <div class="item-input-wrap">
                <input type="number" name="bprice" placeholder="0" value="{{item.bprice}}" />
              </div>
            </div>
          </div>
        </li>

        <li>
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Harga Jual 1</div>
              <div class="item-input-wrap">
                <input type="number" name="xsprice" placeholder="0" value="{{item.xsprice}}" />
              </div>
            </div>
          </div>
        </li>

        <li>
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Harga Jual 2</div>
              <div class="item-input-wrap">
                <input type="number" name="ysprice" placeholder="0" value="{{item.ysprice}}" />
              </div>
            </div>
          </div>
        </li>

        <li>
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Harga Jual 3</div>
              <div class="item-input-wrap">
                <input type="number" name="zsprice" placeholder="0" value="{{item.zsprice}}" />
              </div>
            </div>
          </div>
        </li>


        <li>
            <div class="item-content">
              <div class="item-inner">
                <div class="item-title">Status</div>
                <div class="item-input">
                  <label class="toggle toggle-init color-blue">

                    {{#js_if 'this.item.status > 0'}}
                    <input type="checkbox" name="status" checked>
                    {{else}}
                    <input type="checkbox" name="status">
                    {{/js_if}}
              
                    <span class="toggle-icon"></span>
                  </label>
                </div>
              </div>
            </div>
        </li>

        <li class="align-top">
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Deskripsi</div>
              <div class="item-input-wrap">
                <textarea placeholder="Deskripsi" name="note" class="resizable" value="{{item.note}}"></textarea>
              </div>
            </div>
          </div>
        </li>

        <!-- <li>
          <div class="item-content item-input">
            <div class="item-inner">
              <div class="item-title item-label">Dibuat</div>
              <div class="item-input-wrap">
                <input type="text" name="created" value="{{item.created}}" />
              </div>
            </div>
          </div>
        </li> -->
      </ul>
    </div>
    <div class="block block-strong">
      <p class="row">
        <!-- <a href="#" class="col button item-link list-button logout-button">ButtonXX</a> -->
        <!-- <a @click="updateData" href="#" class="button convert-form-to-data col button-big button-fill button-raised color-green" id="save-btn">Simpan</a> -->
        <!-- <a href="#" class="convert-form-to-data button col button-big button-fill button-raised color-green" id="save-btn">Simpan</a> -->
      </p>
      <p class="row">
        <!-- <a @click="updateData" href="#" class="col button button-fill">Fill</a> -->
        <!-- <a @click="logout" href="#" class="button logout-button col button-big button-fill button-raised color-red" id="logout-btn">Logout</a> -->
        <a href="#" class="qrscanner button logout-button col button-big button-fill button-raised color-red">Back</a>
        <a @click="$root.formToData('#item-form')">FormToData</a>
        <!-- <a @click="$root.formToData('#item-form')">Test Method</a>
        <a @click="$root.onBackKeyDown()">Test Back</a> -->
      </p>
    </div>
    </form>
    <!-- <a @click="updateData" href="#" class="button logout-button col button-big button-fill button-raised color-green" id="logout-btn">Save</a> -->
  </div>
</div>
</template>
<script>
  return {
    //Lifecycle Hooks
    beforeCreate() {
      // console.log('componentBeforeCreate', this);
      var self = this;
      // console.log('pageInit', e, page);
      $$('a.smart-select').on('click', function(){
        // self.$app.dialog.alert('SMART SELECT CLICKED!');
        console.log('SMART SELECT CLICKED!');
      });
      // self.smartSelect = self.$app.smartSelect.create({
        //   el: self.$el.find('.category'),

        //   on: {
        //     opened: function () {
        //     console.log('Smart select opened');
        //     }
        //   }
        // });
    },
    created() {
      // console.log('componentCreated', this);
    },
    beforeMount() {
      // console.log('componentBeforeMount', this);
    },
    mounted() {
      // console.log('componentMounted', this);
    },
    beforeDestroy() {
      // console.log('componentBeforeDestroy', this);
    },
    destroyed() {
      // console.log('componentDestroyed', this);
    },
    // Component Data
    data: function () {
      var categories = [];
      for (var i = 1; i <= 5; i++) {
        categories.push({
          id: i,
          name: 'Item ' + i,
          note: 'Subtitle ' + i,
        });
      }
      var units = [];
      for (var i = 1; i <= 5; i++) {
        units.push({
          id: i,
          name: 'Item ' + i,
          note: 'Subtitle ' + i,
        });
      }
      return {
        // user: JSON.parse(localStorage.user),

        categories: categories,
        units: units,
      };
    },
    // Component Methods
    methods: {

    },
    // Page Events
    on: {
      init:function(e){
        console.log(e);
        console.log('INIT PAGE FORM');
      },
      pageMounted: function(e, page) {
        // console.log('pageMounted', e, page);
      },
      pageInit: function(e, page) {
        var self = this;
        console.log('pageInit', e, page);

        

        app.request({
          url: 'http://khojati.id/titip/api/v2/api.php/records/categories',
          dataType: 'json',
          method: 'GET',
          cache: false,
          crossDomain: true,
          success: function (data) {
            app.preloader.hide(); //var app is initialized by now

            self.$setState({
             categories: data.records
            });
          //some-more-logic
            self.smartSelect = self.$app.smartSelect.create({
              el: self.$el.find('.category'),
              closeOnSelect : true,
              openIn : 'popup',
              searchbar : true,
              searchbarPlaceholder : 'Cari Kategori',
              appendSearchbarNotFound : 'Tidak Ditemukan',
              
            });
          },
          error: function (xhr, status) {
          app.preloader.hide(); //var app is initialized by now
          console.log(xhr);
          console.log(status);
          app.dialog.alert('Terjadi kesalahan koneksi', 'Error');
          }
        });




        app.request({
          url: 'http://khojati.id/titip/api/v2/api.php/records/units',
          dataType: 'json',
          method: 'GET',
          cache: false,
          crossDomain: true,
          success: function (data) {
            app.preloader.hide(); //var app is initialized by now

            self.$setState({
             units: data.records
            });
          //some-more-logic
            self.smartSelect = self.$app.smartSelect.create({
              el: self.$el.find('.unit'),
              closeOnSelect : true,
              openIn : 'sheet',
              
            });
          },
          error: function (xhr, status) {
          app.preloader.hide(); //var app is initialized by now
          console.log(xhr);
          console.log(status);
          app.dialog.alert('Terjadi kesalahan koneksi', 'Error');
          }
        });



















































        // $$('a.smart-select').on('click', function(){
        //   // self.$app.dialog.alert('SMART SELECT CLICKED!');
        //   console.log('SMART SELECT CLICKED!');
        // });
      },
      pageBeforeIn: function(e, page) {
        // console.log('pageBeforeIn', e, page);
      },
      pageAfterIn: function(e, page) {
        // console.log('pageAfterIn', e, page);
      },
      pageBeforeOut: function(e, page) {
        // console.log('pageBeforeOut', e, page);
      },
      pageAfterOut: function(e, page) {
        // console.log('pageAfterOut', e, page);
      },
      pageBeforeRemove: function(e, page) {
        var self = this;
        self.$app.smartSelect.destroy('#category');
        self.$app.smartSelect.destroy('#unit');
        // console.log('pageBeforeRemove', e, page);
      },
    }
  };
</script>